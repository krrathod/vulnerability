<?php
session_start();

//Check Stored Session token and client Session Token 
if($_SESSION["token"]==$_POST["tok"]){

    //Again Generate Token
    function getName() {
        $n=20;
        $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' ;
        $randomString = '';
    
            for ($i = 0; $i < $n; $i++) {
            $index = rand(0, strlen($characters) - 1);
            $randomString .= $characters[$index];
            }
    
        return $randomString;
    }
    
    //Stored Token in Session
    $_SESSION["token"] = getName();
    
  
    //Check username and password is correct or not
        if($_POST['email']=='admin' && $_POST['password']=='admin'){
            echo '<h1 style="text-align:center; color:green;">Login Success</h1>';
        }
        else{
            echo '<h1 style="text-align:center; color:orange;">Incorrect Username and password</h1>';
        }
        

} else{ //If token is not match with client token
    
    echo '<h1 style="text-align:center; color:red;">Token expire</h1>';
}

?>